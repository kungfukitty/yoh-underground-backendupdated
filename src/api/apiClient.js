const API_BASE = import.meta.env.VITE_API_BASE || 'http://localhost:3000';async function http(path,{method='GET',body,token}={}){const headers={'Content-Type':'application/json'};if(token) headers.Authorization=`Bearer ${token}`;const res=await fetch(`${API_BASE}${path}`,{method,headers,credentials:'include',body:body?JSON.stringify(body):undefined});if(!res.ok) throw await res.json().catch(()=>({error:'Request failed'}));return res.json()} export const api={health:()=>http('/api/health'),verifyCode:(code,email)=>http('/api/access/verify-code',{method:'POST',body:{code,email}}),acceptNDA:(payload)=>http('/api/nda/accept',{method:'POST',body:payload}),login:(email,password)=>http('/api/auth/login',{method:'POST',body:{email,password}}),me:(token)=>http('/api/auth/me',{token}),myProfile:(token)=>http('/api/profile',{token}),myItineraries:(token)=>http('/api/itineraries/mine',{token}),myPayments:(token)=>http('/api/payments/mine',{token}),adminRequests:(token,status='pending')=>http(`/api/admin/requests?status=${status}`,{token}),approveRequest:(token,id)=>http(`/api/admin/requests/${id}/approve`,{method:'POST',token}),declineRequest:(token,id)=>http(`/api/admin/requests/${id}/decline`,{method:'POST',token}),accessCodes:(token)=>http('/api/admin/access-codes',{token}),createAccessCode:(token,body)=>http('/api/admin/access-codes',{method:'POST',token,body}),users:(token,q='')=>http(`/api/admin/users?q=${encodeURIComponent(q)}`,{token}),assignPackage:(token,uid,packageId)=>http(`/api/admin/users/${uid}/assign-package`,{method:'POST',token,body:{packageId}}),packages:(token)=>http('/api/admin/packages',{token}),itineraries:(token)=>http('/api/admin/itineraries',{token})};